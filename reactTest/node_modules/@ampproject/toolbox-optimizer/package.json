{
  "_args": [
    [
      {
        "raw": "@ampproject/toolbox-optimizer@1.0.1",
        "scope": "@ampproject",
        "escapedName": "@ampproject%2ftoolbox-optimizer",
        "name": "@ampproject/toolbox-optimizer",
        "rawSpec": "1.0.1",
        "spec": "1.0.1",
        "type": "version"
      },
      "C:\\Users\\david.jolliffe\\Desktop\\hello-next\\node_modules\\next"
    ]
  ],
  "_from": "@ampproject/toolbox-optimizer@1.0.1",
  "_hasShrinkwrap": false,
  "_id": "@ampproject/toolbox-optimizer@1.0.1",
  "_location": "/@ampproject/toolbox-optimizer",
  "_nodeVersion": "10.16.0",
  "_npmOperationalInternal": {
    "host": "s3://npm-registry-packages",
    "tmp": "tmp/toolbox-optimizer_1.0.1_1565122273813_0.562205869776816"
  },
  "_npmUser": {
    "name": "amp-toolbox",
    "email": "amp-toolbox-eng@google.com"
  },
  "_npmVersion": "lerna/3.16.4/node@v10.16.0+x64 (darwin)",
  "_phantomChildren": {},
  "_requested": {
    "raw": "@ampproject/toolbox-optimizer@1.0.1",
    "scope": "@ampproject",
    "escapedName": "@ampproject%2ftoolbox-optimizer",
    "name": "@ampproject/toolbox-optimizer",
    "rawSpec": "1.0.1",
    "spec": "1.0.1",
    "type": "version"
  },
  "_requiredBy": [
    "/next"
  ],
  "_resolved": "https://registry.npmjs.org/@ampproject/toolbox-optimizer/-/toolbox-optimizer-1.0.1.tgz",
  "_shasum": "5eeda7bc84c23237479c35442d4696c4bdbeb1d3",
  "_shrinkwrap": null,
  "_spec": "@ampproject/toolbox-optimizer@1.0.1",
  "_where": "C:\\Users\\david.jolliffe\\Desktop\\hello-next\\node_modules\\next",
  "author": {
    "name": "AMPHTML Team"
  },
  "bugs": {
    "url": "https://github.com/ampproject/amp-toolbox/issues"
  },
  "dependencies": {
    "@ampproject/toolbox-core": "^1.0.1",
    "@ampproject/toolbox-runtime-version": "^1.0.1",
    "css": "2.2.4",
    "parse5": "5.1.0",
    "parse5-htmlparser2-tree-adapter": "5.1.0"
  },
  "description": "Server-side rendering for AMPs.",
  "devDependencies": {},
  "directories": {},
  "dist": {
    "integrity": "sha512-zz1cJsQWBvfg2h1ce2/bbgNdSkTjIY7PaF7QhWMzYVcfvdxGSAykA+Ajt+F13H6adNAtIn09s96z/+6pn7XiXQ==",
    "shasum": "5eeda7bc84c23237479c35442d4696c4bdbeb1d3",
    "tarball": "https://registry.npmjs.org/@ampproject/toolbox-optimizer/-/toolbox-optimizer-1.0.1.tgz",
    "fileCount": 25,
    "unpackedSize": 94311,
    "npm-signature": "-----BEGIN PGP SIGNATURE-----\r\nVersion: OpenPGP.js v3.0.4\r\nComment: https://openpgpjs.org\r\n\r\nwsFcBAEBCAAQBQJdSd7iCRA9TVsSAnZWagAAMZAP/R6hsYp8bx4hFj7Y0Tnl\nRJc3XIHQyAi2axK69G/FN8HgnSNYReATOYEwpS+zkFXD02zbItCNAWN+91nZ\nZ/RBzIDxZUS0K69nWzuCoP8kcz2DObFLl60q9jYWtmS418yT7eQRLdQIjNE9\nkYKLp1G0MSdCBYdLd0rmSTED5z9lJr7njVxx2/+wGz3nQoq0h88rwsvjy/Cx\nRrNxEmsfH+1J154TUNureJwVmKIMf7gIamqat54Lfnfdh8rUKRFdv2Qt1Iab\nn0NOAUPC7en3k9oc9VfcWsGbovUCQD4Z5wyiQ3eT7P6oUd4YwtXqAZggDag5\nwOIEtyXRRE/NI4CJJjycRx5XoLRsnTBfmjUdsWKdzZaMSuYEyjJYhS0h6ib5\naLJQnydcMzhHVwCE51v3pUq+zzs5c9HxLf1duHAhWX+RziGtWj5WHprrOnSH\nEbzpTqHO7UFNa1eOtnfqvdReQZzi2Jtvctal6Qte/yU5pFKa1ffnLIlZbrSV\nW9o2CaDo78b4MaGHr5M0FUXi3+6RhHFnvEtSadP2KgoRAQ/nkaLJ+UZ3Kl5o\npQdrvYSGAs6++yDaQNtxZ2kwDGJBf7fqEPGL3q+YVBiWrYRXavUQi65VRVDH\nsb6HWV/UHliMpx5hDaNRf3xBTqtFoVg5uXxQBXExmf8bPpIsyq73TRCs8Yff\ntCSq\r\n=AfOM\r\n-----END PGP SIGNATURE-----\r\n"
  },
  "files": [
    "index.js",
    "lib"
  ],
  "gitHead": "4da05d4a419241bbcc8157553022af3a84676e9a",
  "homepage": "https://github.com/ampproject/amp-toolbox/tree/master/packages/optimizer",
  "keywords": [
    "amp"
  ],
  "license": "Apache-2.0",
  "main": "index.js",
  "maintainers": [
    {
      "name": "amp-toolbox",
      "email": "amp-toolbox-eng@google.com"
    },
    {
      "name": "ampproject-admin",
      "email": "admin@ampproject.org"
    },
    {
      "name": "choumx",
      "email": "willchou@google.com"
    },
    {
      "name": "jridgewell",
      "email": "justin+npm@ridgewell.name"
    },
    {
      "name": "kristoferbaxter",
      "email": "kbax@me.com"
    },
    {
      "name": "prateekbh",
      "email": "prateek89born@gmail.com"
    },
    {
      "name": "sepandparhami",
      "email": "sparhami@google.com"
    }
  ],
  "name": "@ampproject/toolbox-optimizer",
  "optionalDependencies": {},
  "peerDependenciesMeta": {
    "jimp": {
      "optional": true
    },
    "lru-cache": {
      "optional": true
    }
  },
  "readme": "# AMP Optimizer \n\n[![npm version](https://badge.fury.io/js/@ampproject/toolbox-optimizer.svg)](https://badge.fury.io/js/@ampproject/toolbox-optimizer)\n\nAMP Optimizer is a tool to server-side enhance the rendering performance of AMP pages. AMP Optimizer implements [AMP performance best practices](https://amp.dev/documentation/guides-and-tutorials/optimize-and-measure/optimize_amp?format=websites) and supports [AMP server-side-rendering](https://amp.dev/documentation/guides-and-tutorials/optimize-and-measure/server-side-rendering?format=websites). By default, it will perform the following optimizations:\n\n* Server-side render AMP layouts.\n* Remove the AMP boilerplate (when possible).\n* Inline critical CSS.\n* Speed-up AMP framework and custom font loading.\n* Move CSS keyframe animations to the bottom of the page.\n\nThe performance optimizations can improve page rendering times by up to 50%. You can read more about the potential performance gains in this [blog post](https://blog.amp.dev/2018/10/08/how-to-make-amp-even-faster/).\n\n**Important: AMP Optimizer will produce valid AMP, if the input is valid AMP.**\n\n* [Usage](#usage)\n* [Best Practices](#best-practices)\n  + [Regenerate pages at least once a week](#regenerate-pages-at-least-once-a-week)\n  + [Debugging](#debugging)\n  + [Transform AMP pages at build time if possible](#transform-amp-pages-at-build-time-if-possible)\n  + [Cache transformed AMPs at runtime](#cache-transformed-amps-at-runtime)\n* [Experimental Features](#experimental-features)\n  + [Paired AMP](#paired-amp)\n  + [Versioned AMP Runtime](#versioned-amp-runtime)\n  + [Blurry image placeholders](#blurry-image-placeholders)\n  + [Self-hosted AMP components](#self-hosted-amp-components)\n\n## Usage\n\nInstall via:\n\n```\nnpm install @ampproject/toolbox-optimizer\n```\n\nMinimal usage:\n\n```js\nconst AmpOptimizer = require('@ampproject/toolbox-optimizer');\n\nconst ampOptimizer = AmpOptimizer.create();\n\nconst originalHtml = `\n<!doctype html>\n<html ⚡>\n  ...\n</html>\n`\n\nampOptimizer.transformHtml(originalHtml).then(optimizedHtml => {\n  console.log(optimizedHtml);\n});\n\n```\n\nYou can find a sample implementation [here](demo/simple/). If you're using express to serve your site, you can use the [AMP Optimizer Middleware](../optimizer-express).\n\nThere's also a [command line version](../cli/README.md) available:\n\n```shell\n$ npx @ampproject/toolbox-cli myFile.html\n```\n\n## Best Practices\n\n### Regenerate pages at least once a week\n\nAMP Optimizer inlines CSS styles required by AMP. To make sure, that the inlined CSS stays in sync with the latest AMP release, we recommend to re-generate pages at least once a week. The good news is, out-of-sync CSS will not break your page, as AMP will check the version of the inlined CSS at runtime and will automatically update it to the latest version.\n\n### Debugging\n\nEnable `verbose` mode to find out why the AMP boilerplate is not being removed. You can\nenable verbose mode either when creating a new optimizer instance:\n\n```\n// globally\nconst optimizer = ampOptimizer.create({\n  verbose: true\n});\n```\n\n... or for individual pages:\n\n```\n// per transformation\nampOptimizer.transformHtml(originalHtml, {\n  verbose: true\n})\n```\n\n### Transform AMP pages at build time if possible\n\nApplying the transformations to an AMP file consumes additional server resources. Also, since the entire file is needed to apply the transformations, it also becomes impossible to stream the response while applying it. In order to avoid server overhead, if the set of AMP files to be transformed is known in advance, transformations should be run at build time.\n\n### Cache transformed AMPs at runtime\n\nMost websites have a more dynamic nature though and are not able to apply the transformations statically. For such cases it is possible to run the transformations after AMP pages are rendered, e.g. in an Express middleware. In that case, to achieve best performance, it's best to cache transformed pages for subsequent requests. Caching can take place on the CDN level, on the site's internal infrastructure (eg: Memcached), or even on the server itself, if the set of pages is small enough to fit in memory.\n\n## Experimental Features\n\n**Warning: these features are experimental and might result in invalid AMP pages.**\n\n### Paired AMP \n\nWhen using experimental features resulting in invalid AMP it's best to setup paired AMP mode. Paired AMP mode will add `<link rel=amphtml href=${ampUrl}>` to the transformed page, were `ampUrl` needs to point to the valid version of this page.\n\nExample:\n\n```\nconst optimizer = AmpOptimizer.create({\n  transformations: AmpOptimizer.TRANSFORMATIONS_PAIRED_AMP,\n});\nconst ampFilePath = filePath.substring(1, filePath.length)\n    .replace('.html', '.amp.html');\nconst transformedHtml = await optimizer.transformHtml(html, {\n  // needed to calculate the `<link rel=amphtml href=${ampUrl}>`\n  ampUrl: ampFilePath,\n});\n```\n\n### Versioned AMP Runtime\n\nThe `ampRuntimeVersion` parameter will rewrite all AMP runtime and extension imports to the specified version. For example: \n\n```\nhttps://cdn.ampproject.org/v0.js\n```\n\nwill be replaced with:\n\n```\nhttps://cdn.ampproject.org/rtv/001515617716922/v0.js\n```\n\nVersioning the AMP runtime URLs has one main benefit: versioned AMP runtime URLs are served with a longer max-age than the unversioned ones. This means AMP pages served with versioned AMP runtime benefit from better browser caching.\n\n**Important:** when using versioned AMP runtime URLs make sure to invalidate all caches whenever a new AMP runtime is released. This is to ensure that your AMP pages always use the latest version of the AMP runtime.  \n\nYou can use [@ampproject/toolbox-runtime-version](../@ampproject/toolbox-runtime-version) to retrieve the latest version of the AMP runtime. Here is a sample to apply the optimizations including versioning the URLs:\n\n```\nconst ampOptimizer = require('@ampproject/toolbox-optimizer');\nconst ampRuntimeVersion = await runtimeVersion.currentVersion();\n\n// The input string\nconst originalHtml = `\n<!doctype html>\n<html ⚡>\n...\n`\n\n// Additional options can be passed as the second argument\nconst optimizedHtml = await ampOptimizer.transformHtml(originalHtml, {\n  ampUrl: 'canonical.amp.html',\n  ampRuntimeVersion: ampRuntimeVersion\n});\n\nconsole.log(optimizedHtml);\n```\n\n### Blurry image placeholders\n\nAdd placeholders for `amp-img` and `amp-video` posters. The placeholders are blurry versions of the corresponding original source. The blur will be displayed as the `<amp-img>` is rendering, and will fade out once the element is loaded. The current requirements of appending a blurry placeholder is for the element is to be a JPEG that is either responsive or a poster for an `amp-video`.\n\n**Important: blurry image placeholder computation is computationally expensive. Make sure to only use it for static or cached pages.**\n\nThis transformer supports the following options:\n\n* `blurredPlaceholders`: Enables blurry image placeholder generation. Default is `false`.\n* `imageBasePath`: specifies a base path used to resolve an image during build.\n* `maxBlurredPlaceholders`: Specifies the max number of blurred images. Defaults to 5.\n* `blurredPlaceholdersCacheSize`: Specifies the max number of blurred images to be cached\n  to avoid expensive recalculation. Set to 0 if caching should be disabled. Set to -1 if\n  all placeholders should be cached (good for static sites). Defaults to 30.\n\nUsage: \n\n```\nconst optimizer = AmpOptimizer.create({\n  // blurry image placeholders are currently not considered valid AMP\n  // hence it's recommended to setup paired AMP mode when enabling this feature.\n  transformations: AmpOptimizer.TRANSFORMATIONS_PAIRED_AMP,\n  blurredPlaceholders: true,\n});\n```\n\n### Self-hosted AMP components\n\nIt's possible to rewrite the AMP framework and component imports to a different domain than `cdn.ampproject.org`.\n\nExample:\n```\nconst ampOptimizer = require('@ampproject/toolbox-optimizer');\n\n// The input string\nconst originalHtml = `\n<!doctype html>\n<html ⚡>\n...\n`\n\n// Additional options can be passed as the second argument\nconst optimizedHtml = await ampOptimizer.transformHtml(originalHtml, {\n  ampUrl: 'canonical.amp.html',\n  // this will rewrite https://cdn.ampproject.org/v0.js to /amp/v0.js\n  ampUrlPrefix: '/amp'\n});\n\nconsole.log(optimizedHtml);\n```\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git+https://github.com/ampproject/amp-toolbox.git"
  },
  "version": "1.0.1"
}
